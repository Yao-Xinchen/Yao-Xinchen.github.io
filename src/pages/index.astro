---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

// Get projects from Content Collections
const projectsCollection = await getCollection('projects');
const projects = projectsCollection
	.map(p => ({
		...p.data,
		slug: p.id.replace('.md', ''),
	}))
	// Sort by order field (if present), then by slug
	.sort((a, b) => {
		if (a.order !== undefined && b.order !== undefined) {
			return a.order - b.order;
		}
		if (a.order !== undefined) return -1;
		if (b.order !== undefined) return 1;
		return a.slug.localeCompare(b.slug);
	});

const skills = {
	"Robotics": ["Robotics Learning", "Model-Based Control", "Low-Level Control"],
	"Programming": ["Python", "C++", "CUDA", "MATLAB", "Rust"],
	"Systems": ["Linux/Unix", "Embedded Systems"],
	"Tools": [
		"Isaac Lab", "Genesis", "Mujoco Playground", "PyTorch", "Jax",
		"ROS/ROS2", "SLAM", "STM32", "CAD",
	]
};
---

<Layout>
	<!-- Hero Section -->
	<section id="hero">
		<div class="hero-content">
			<!-- Profile Photo -->
			<img
				src="/profile.png"
				alt="Xinchen Yao"
				class="profile-photo"
				onerror="this.style.display='none'"
			/>

			<h1 class="hero-title">Xinchen Yao</h1>
			<p class="hero-subtitle">Computer Engineering Student</p>
			<p class="hero-university">
				<a href="https://zjui.illinois.edu" target="_blank" rel="noopener noreferrer">
					Zhejiang University - University of Illinois Urbana-Champaign Institute
				</a>
			</p>
			<p class="hero-tagline">Specializing in Robotics Learning and Low-Level Controlling</p>

			<p class="hero-description">
				Passionate about robotics from sensors to algorithms. Started with low-level control systems.
				Now, focusing on learning-based robotics.
			</p>

			<a href="#projects" class="hero-cta">View Projects ↓</a>
		</div>
	</section>

	<!-- Main Content Area with Sidebar -->
	<div class="main-container" id="projects">
		<!-- Sticky Sidebar -->
		<aside class="sidebar">
			<!-- Contact Section -->
			<div class="sidebar-card">
				<h3 class="sidebar-title">Let's Connect</h3>
				<div class="contact-links">
					<a href="https://github.com/Yao-Xinchen" target="_blank" rel="noopener noreferrer" class="contact-link">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
							<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
						</svg>
						<span>Yao-Xinchen</span>
					</a>
					<a href="mailto:yao29@illinois.edu" class="contact-link">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<rect x="2" y="4" width="20" height="16" rx="2"/>
							<path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
						</svg>
						<span>yao29@illinois.edu</span>
					</a>
					<a href="mailto:xinchen.22@intl.zju.edu.cn" class="contact-link">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<rect x="2" y="4" width="20" height="16" rx="2"/>
							<path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
						</svg>
						<span>xinchen.22@intl.zju.edu.cn</span>
					</a>
					<!-- <a href="https://physicalintelligence-lab.github.io/" target="_blank" rel="noopener noreferrer" class="contact-link">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
							<path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
						</svg>
						<span>PHI Lab Website</span>
					</a> -->
				</div>
			</div>

			<!-- Skills Section -->
			<div class="sidebar-card">
				<h3 class="sidebar-title">Skills</h3>
				<div class="skills-content">
					{Object.entries(skills).map(([category, items]) => (
						<div class="skill-category">
							<h4 class="skill-category-title">{category}</h4>
							<div class="skill-tags">
								{items.map((skill) => (
									<span class="skill-tag">{skill}</span>
								))}
							</div>
						</div>
					))}
				</div>
			</div>
		</aside>

		<!-- Projects Section -->
		<main class="projects-section">
			<h2 class="section-title">Projects</h2>
			<p class="section-description">
				A collection of robotics projects.
			</p>

			<div class="projects-grid">
				{projects.map((project) => (
					<article class="project-card">
						<a href={`/projects/${project.slug}`} class="project-card-link">
							<div class="project-image-container">
								<img
									src={project.image}
									alt={project.title}
									class="project-image"
									onerror="this.src='https://via.placeholder.com/600x400/1e40af/ffffff?text=Add+Project+Image'"
								/>
								<span class="project-category-badge">{project.category}</span>
							</div>

							<div class="project-content">
								<h3 class="project-title">{project.title}</h3>
								<p class="project-description">{project.description}</p>

								<div class="project-tech">
									{project.technologies.map((tech) => (
										<span class="tech-badge">{tech}</span>
									))}
								</div>

								<div class="project-actions">
									<span class="view-details">View Details →</span>
								</div>
							</div>
						</a>

						{(project.github || project.video || project.website) && (
							<div class="project-external-links">
								{project.github && typeof project.github === 'string' && (
								<a href={project.github} target="_blank" rel="noopener noreferrer" class="project-link" onclick="event.stopPropagation()">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
										<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
									</svg>
									Source Code
								</a>
							)}
							{project.github && Array.isArray(project.github) && (
								<a href={project.github[0].url} target="_blank" rel="noopener noreferrer" class="project-link" onclick="event.stopPropagation()">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
										<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
									</svg>
									Source Code
								</a>
							)}
							{project.website && (
								<a href={project.website} target="_blank" rel="noopener noreferrer" class="project-link" onclick="event.stopPropagation()">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<circle cx="12" cy="12" r="10"/>
										<line x1="2" y1="12" x2="22" y2="12"/>
										<path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
									</svg>
									Website
								</a>
							)}
							{project.video && (
								<a href={project.video} target="_blank" rel="noopener noreferrer" class="project-link" onclick="event.stopPropagation()">
									<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<polygon points="5 3 19 12 5 21 5 3"/>
									</svg>
									Video Demo
								</a>
							)}
							</div>
						)}
					</article>
				))}
			</div>
		</main>
	</div>
</Layout>

<style>
	/* Hero Section */
	#hero {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 2rem;
		background: linear-gradient(135deg, #f9fafb 0%, #e0f2fe 100%);
		position: relative;
	}

	.hero-content {
		max-width: 800px;
		text-align: center;
	}

	.profile-photo {
		width: 360px;
		height: 360px;
		border-radius: 50%;
		object-fit: cover;
		margin-bottom: 2rem;
		border: 4px solid white;
		box-shadow: var(--shadow-lg);
		transition: transform 0.3s ease;
	}

	.profile-photo:hover {
		transform: scale(1.05);
	}

	.hero-title {
		font-size: 3.5rem;
		font-weight: 700;
		margin-bottom: 0.5rem;
		color: var(--color-text);
		background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent) 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	.hero-subtitle {
		font-size: 1.4rem;
		color: var(--color-primary);
		margin-bottom: 0.5rem;
		font-weight: 500;
	}

	.hero-university {
		font-size: 1.4rem;
		margin-bottom: 0.5rem;
		font-weight: 500;
	}

	.hero-university a {
		color: var(--color-primary);
		text-decoration: none;
		transition: color 0.2s ease;
		border-bottom: 2px solid transparent;
		padding-bottom: 2px;
	}

	.hero-university a:hover {
		color: var(--color-primary);
		border-bottom-color: var(--color-primary);
	}

	.hero-tagline {
		font-size: 1.25rem;
		color: var(--color-text-light);
		margin-bottom: 1.5rem;
	}

	.hero-description {
		font-size: 1.1rem;
		color: var(--color-text);
		line-height: 1.8;
		margin-bottom: 2rem;
		max-width: 600px;
		margin-left: auto;
		margin-right: auto;
	}

	.hero-cta {
		display: inline-block;
		padding: 1rem 2rem;
		background: var(--color-primary);
		color: white;
		border-radius: var(--border-radius);
		font-weight: 600;
		font-size: 1.1rem;
		transition: all 0.3s ease;
		box-shadow: var(--shadow-md);
	}

	.hero-cta:hover {
		background: var(--color-accent);
		transform: translateY(-2px);
		box-shadow: var(--shadow-lg);
	}

	/* Main Container Layout */
	.main-container {
		max-width: 1400px;
		margin: 0 auto;
		padding: 4rem 2rem;
		display: grid;
		grid-template-columns: 280px 1fr;
		gap: 3rem;
	}

	/* Sticky Sidebar */
	.sidebar {
		position: sticky;
		top: 2rem;
		align-self: start;
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
	}

	.sidebar-card {
		background: white;
		border-radius: var(--border-radius);
		padding: 1.5rem;
		box-shadow: var(--shadow-md);
		border: 1px solid var(--color-border);
	}

	.sidebar-title {
		font-size: 1.25rem;
		margin-bottom: 1rem;
		color: var(--color-text);
	}

	/* Skills */
	.skills-content {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}

	.skill-category {
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
	}

	.skill-category-title {
		font-size: 0.875rem;
		font-weight: 600;
		color: var(--color-primary);
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.skill-tags {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
	}

	.skill-tag {
		display: inline-block;
		padding: 0.25rem 0.75rem;
		background: var(--color-surface);
		color: var(--color-text);
		border-radius: 6px;
		font-size: 0.875rem;
		border: 1px solid var(--color-border);
	}

	/* Contact */
	.contact-links {
		display: flex;
		flex-direction: column;
		gap: 0.75rem;
	}

	.contact-link {
		display: flex;
		align-items: center;
		gap: 0.75rem;
		padding: 0.75rem;
		border-radius: 8px;
		transition: all 0.2s ease;
		color: var(--color-text);
		min-width: 0; /* Allow flexbox to shrink */
	}

	.contact-link:hover {
		background: var(--color-surface);
		color: var(--color-primary);
		transform: translateX(4px);
	}

	.contact-link svg {
		flex-shrink: 0;
	}

	.contact-link span {
		overflow: hidden;
		text-overflow: ellipsis;
		white-space: nowrap;
		font-size: 0.875rem;
		min-width: 0; /* Allow text to shrink */
	}

	/* Projects Section */
	.projects-section {
		min-height: 100vh;
	}

	.section-title {
		font-size: 2.5rem;
		margin-bottom: 0.5rem;
		color: var(--color-text);
	}

	.section-description {
		font-size: 1.1rem;
		color: var(--color-text-light);
		margin-bottom: 2rem;
	}

	.projects-grid {
		display: grid;
		gap: 2rem;
		grid-template-columns: 1fr;
	}

	/* Project Card */
	.project-card {
		background: white;
		border-radius: var(--border-radius);
		overflow: hidden;
		box-shadow: var(--shadow-md);
		border: 1px solid var(--color-border);
		transition: all 0.3s ease;
		display: flex;
		flex-direction: column;
	}

	.project-card:hover {
		transform: translateY(-4px);
		box-shadow: var(--shadow-lg);
	}

	.project-card-link {
		text-decoration: none;
		color: inherit;
		display: block;
		flex: 1;
	}

	.project-image-container {
		position: relative;
		width: 100%;
		height: 300px;
		overflow: hidden;
		background: var(--color-surface);
	}

	.project-image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 0.3s ease;
	}

	.project-card:hover .project-image {
		transform: scale(1.05);
	}

	.project-category-badge {
		position: absolute;
		top: 1rem;
		right: 1rem;
		background: rgba(30, 64, 175, 0.9);
		color: white;
		padding: 0.5rem 1rem;
		border-radius: 6px;
		font-size: 0.875rem;
		font-weight: 600;
		backdrop-filter: blur(4px);
	}

	.project-content {
		padding: 1.5rem;
	}

	.project-title {
		font-size: 1.5rem;
		margin-bottom: 0.75rem;
		color: var(--color-text);
	}

	.project-description {
		color: var(--color-text-light);
		margin-bottom: 1rem;
		line-height: 1.6;
	}

	.project-tech {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
		margin-bottom: 1rem;
	}

	.tech-badge {
		padding: 0.375rem 0.75rem;
		background: var(--color-surface);
		color: var(--color-primary);
		border-radius: 6px;
		font-size: 0.875rem;
		font-weight: 500;
		border: 1px solid var(--color-border);
	}

	.project-actions {
		margin-top: 0.5rem;
	}

	.view-details {
		display: inline-block;
		color: var(--color-primary);
		font-weight: 600;
		font-size: 0.95rem;
	}

	.project-card-link:hover .view-details {
		color: var(--color-accent);
	}

	.project-external-links {
		display: flex;
		gap: 1rem;
		flex-wrap: wrap;
		padding: 1rem 1.5rem;
		border-top: 1px solid var(--color-border);
		background: var(--color-surface);
	}

	.project-link {
		display: inline-flex;
		align-items: center;
		gap: 0.5rem;
		padding: 0.625rem 1.25rem;
		color: var(--color-primary);
		background: white;
		border: 2px solid var(--color-primary);
		border-radius: 6px;
		font-weight: 500;
		transition: all 0.2s ease;
		font-size: 0.875rem;
	}

	.project-link:hover {
		background: var(--color-primary);
		color: white;
		transform: translateY(-1px);
		box-shadow: var(--shadow-sm);
	}

	/* Responsive Design */
	@media (max-width: 1024px) {
		.main-container {
			grid-template-columns: 240px 1fr;
			gap: 2rem;
		}

		.hero-title {
			font-size: 2.5rem;
		}
	}

	@media (max-width: 768px) {
		.main-container {
			grid-template-columns: 1fr;
			padding: 2rem 1rem;
		}

		.sidebar {
			position: static;
			order: 2;
		}

		.projects-section {
			order: 1;
		}

		.profile-photo {
			width: 140px;
			height: 140px;
		}

		.hero-title {
			font-size: 2rem;
		}

		.hero-subtitle {
			font-size: 1.25rem;
		}

		.hero-university {
			font-size: 0.95rem;
		}

		.hero-tagline {
			font-size: 1rem;
		}

		.hero-description {
			font-size: 1rem;
		}

		.section-title {
			font-size: 2rem;
		}
	}
</style>

<script>
	// Smooth scroll for anchor links
	document.querySelectorAll('a[href^="#"]').forEach(anchor => {
		anchor.addEventListener('click', (e) => {
			e.preventDefault();
			const targetId = anchor.getAttribute('href');
			const targetElement = targetId ? document.querySelector(targetId) : null;

			if (targetElement) {
				targetElement.scrollIntoView({
					behavior: 'smooth',
					block: 'start'
				});
			}
		});
	});
</script>
